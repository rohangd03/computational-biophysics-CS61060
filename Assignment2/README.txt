Author: ROHAN GHOSH DASTIDAR	22CH30028
COMPUTATIONAL BIOPHYSICS - ASSIGNMENT 2

Problem Definition:
You are given with a target protein-protein complex (experimental) structure and a list of (computational) docking decoys generated by some docking techqniue for the same protein structure. Write a program (in C or C++ or Python language) that for each decoys will compute the Interface Area, LRMSD, IRMSD, Fnat and Solvation Energy

============================================================================================

WHAT DOES THE PROGRAM DO??
============================================================================================
This program the "goodness of fit" of decoys by calculating - 
1. Interface Area (IA) [A^2]
2. Solvation Energy [kcal/mol]
3. Ligand RMSD (LRMSD) [A]
4. Interface RMSD (IRMSD) [A]
5. Fnat Score [0-1]

============================================================================================

HOW TO EXECUTE THE FILE??
1. Open terminal
2. Go to the folder containing the A2_22CH30028.py file
3. Type "py A2_22CH30028.py" in terminal

============================================================================================
DISCLAIMER - This code is designed to run on a Windows environment with NACCESS being executed through WSL (Windows Subsystem for Linux). Also, the decoys are initially named as "complex.1.pdb", "complex.2.pdb". Due to the presence of multiple "."'s in the file name, it was causing issues with parsing the files. Therefore, my code first renames the files to "complex_1.pdb", "complex_2.pdb", etc. and then executes the rest of the code.
============================================================================================

STEP 1: Install dependencies

LIBRARIES USED -  
subprocess
os
requests
pathib

============================================================================================

STEP 2: Prepare required files

/A2_22CH3028.zip/ 	(Root folder)
│── A2_22CH30028.py
│── target.pdb
│── /Decoys/
	│── complex_1.pdb
	│── complex_2.pdb
	│── complex_3.pdb
	│── ...
	│── complex_10.pdb	
│── README.txt

============================================================================================

STEP 3: In the "main" execution block of the program (( __name__ == "__main__" )), make changes to paths to access the necessary files
# Paths for WSL - UBUNTU Compatible
    naccess_path = Add the path in the system where the [[naccess]] files are stored
    root_folder = Absolute path to the A2_22CH30028 folder obtained after unzipping the A2_22CH30028.zip

# Paths for File Handing - WINDOWS Compatible
    path_to_PDB = Add the path to the /Decoys/ folder
    target_location = Add the path to /target.pdb/ file
    target_root = Add the path to the folder containing /target.pdb/ file (here, A2_22CH30028)

============================================================================================

STEP 4: Description of the functions

1. download_pdb(pdb_id, save_path) - Downloads a PDB file from the RCSB Protein Data Bank (PDB) and saves it to the specified directory (not needed necessarily, but can be used if we need to downloaded pdb files that are not in the folder)

2. get__no__of__chains(pdb_file) - Extracts the number of chains in a complex.

3. extract__chains(pdb_file, chain_id, output_file) - Extracts a specified chain from the complex and saves it as a separate PDB file.

4. run_naccess(file_path, naccess_path) - Executes the NACCESS software on a given PDB file to compute solvent accessible surface area.

5. calculate__solvent__accessible__area(file_path) - Computes the total solvent accessible surface area (ASA) from an NACCESS .asa file by summing up the ASA values of each atoms.

6. find_interface_atoms(chain_file_path, complex_file_path) - Identifies interface atoms by comparing the solvent accessibility (ASA) of atoms in an individual chain with their ASA in the full complex. Atoms with an ASA reduction greater than a threshold (0.1 Å²) are classified as interface atoms.

7. get_solvation_parameter(atom_name, residue_name) - Assigns solvation parameters to atoms based on their type and residue. (Refer to paper)

8. compute_solvation_energy(interface_atoms) - Calculates the solvation energy based on the ASA reduction of interface atoms and their respective solvation parameters.

9. calculate_LRMSD(file_path) - Extracts the atomic coordinates of all ligand atoms from a given PDB file for computing the Ligand RMSD (LRMSD).

10. find_iRMSD_coordinates(file_path, list_of_interface_atoms) - Extracts the atomic coordinates of interface residues for calculating Interface RMSD (IRMSD).

11. calculate_Fnat(target_path, decoy_path) - Calculates the Fraction of Native Contacts (Fnat) by comparing no. of interface Amino acids in the target to the no. of interface residues in the decoy structures.

============================================================================================

STEP 5: OUTPUT
│── score.txt output is stored in the A2_22CH30028 folder. If present already, the program overwrites previously stored data in the score.txt file.